#!/usr/bin/env python

from __future__ import print_function

import pprint


microbench_output = \
"""
ncodebooks = 4
amm multisplit N, D, M, ncodebooks:  10000, 512,  10,  4     (5x5): 0.04 (2504000000/s), 0.035 (2861714285/s), 0.035 (2861714285/s), 0.035 (2861714285/s), 0.035 (2861714285/s),
amm multisplit N, D, M, ncodebooks:  10000, 512, 100,  4     (5x5): 0.228 (4392982456/s), 0.222 (4511711711/s), 0.209 (4792344497/s), 0.216 (4637037037/s), 0.217 (4615668202/s),
amm multisplit N, D, M, ncodebooks:  57593,  24,   3,  4     (5x5): 0.176 (981818181/s), 0.165 (1047272727/s), 0.168 (1028571428/s), 0.162 (1066666666/s), 0.161 (1073291925/s),
amm multisplit N, D, M, ncodebooks: 115193,  24,   3,  4     (5x5): 0.423 (817021276/s), 0.467 (740042826/s), 0.449 (769710467/s), 0.45 (768000000/s), 0.452 (764601769/s),
amm multisplit N, D, M, ncodebooks: 230393,  24,   3,  4     (5x5): 1.031 (670417070/s), 1.005 (687761194/s), 1.004 (688446215/s), 1.006 (687077534/s), 0.976 (708196721/s),
amm multisplit N, D, M, ncodebooks:  49284,  27,   2,  4     (5x5): 0.132 (747151515/s), 0.131 (752854961/s), 0.145 (680165517/s), 0.144 (684888888/s), 0.126 (782730158/s),
ncodebooks = 8
amm multisplit N, D, M, ncodebooks:  10000, 512,  10,  8     (5x5): 0.064 (1565000000/s), 0.065 (1540923076/s), 0.065 (1540923076/s), 0.064 (1565000000/s), 0.064 (1565000000/s),
amm multisplit N, D, M, ncodebooks:  10000, 512, 100,  8     (5x5): 0.302 (3316556291/s), 0.339 (2954572271/s), 0.318 (3149685534/s), 0.312 (3210256410/s), 0.311 (3220578778/s),
amm multisplit N, D, M, ncodebooks:  57593,  24,   3,  8     (5x5): 0.341 (506744868/s), 0.334 (517365269/s), 0.329 (525227963/s), 0.325 (531692307/s), 0.34 (508235294/s),
amm multisplit N, D, M, ncodebooks: 115193,  24,   3,  8     (5x5): 0.956 (361506276/s), 0.974 (354825462/s), 0.941 (367268862/s), 0.939 (368051118/s), 0.937 (368836712/s),
amm multisplit N, D, M, ncodebooks: 230393,  24,   3,  8     (5x5): 1.943 (355738548/s), 1.996 (346292585/s), 1.899 (363981042/s), 1.917 (360563380/s), 1.906 (362644281/s),
amm multisplit N, D, M, ncodebooks:  49284,  27,   2,  8     (5x5): 0.247 (399287449/s), 0.247 (399287449/s), 0.246 (400910569/s), 0.246 (400910569/s), 0.247 (399287449/s),
ncodebooks = 16
amm multisplit N, D, M, ncodebooks:  10000, 512,  10, 16     (5x5): 0.147 (681360544/s), 0.129 (776434108/s), 0.127 (788661417/s), 0.125 (801280000/s), 0.124 (807741935/s),
amm multisplit N, D, M, ncodebooks:  10000, 512, 100, 16     (5x5): 0.556 (1801438848/s), 0.589 (1700509337/s), 0.589 (1700509337/s), 0.562 (1782206405/s), 0.557 (1798204667/s),
amm multisplit N, D, M, ncodebooks:  57593,  24,   3, 16     (5x5): 0.642 (269158878/s), 0.648 (266666666/s), 0.632 (273417721/s), 0.627 (275598086/s), 0.629 (274721780/s),
amm multisplit N, D, M, ncodebooks: 115193,  24,   3, 16     (5x5): 1.753 (197147746/s), 1.732 (199538106/s), 1.65 (209454545/s), 1.648 (209708737/s), 1.652 (209200968/s),
amm multisplit N, D, M, ncodebooks: 230393,  24,   3, 16     (5x5): 3.811 (181369719/s), 3.823 (180800418/s), 3.774 (183147853/s), 3.748 (184418356/s), 3.698 (186911844/s),
amm multisplit N, D, M, ncodebooks:  49284,  27,   2, 16     (5x5): 0.516 (191131782/s), 0.552 (178666666/s), 0.512 (192625000/s), 0.511 (193001956/s), 0.52 (189661538/s),
ncodebooks = 32
amm multisplit N, D, M, ncodebooks:  10000, 512,  10, 32     (5x5): 0.371 (269973045/s), 0.278 (360287769/s), 0.284 (352676056/s), 0.277 (361588447/s), 0.273 (366886446/s),
amm multisplit N, D, M, ncodebooks:  10000, 512, 100, 32     (5x5): 1.091 (918056828/s), 1.063 (942238946/s), 1.115 (898295964/s), 1.099 (911373976/s), 1.121 (893487957/s),
amm multisplit N, D, M, ncodebooks:  57593,  24,   3, 32     (5x5): 1.434 (120502092/s), 1.314 (131506849/s), 1.312 (131707317/s), 1.372 (125947521/s), 1.371 (126039387/s),
amm multisplit N, D, M, ncodebooks: 115193,  24,   3, 32     (5x5): 3.374 (102430349/s), 3.248 (106403940/s), 3.242 (106600863/s), 3.24 (106666666/s), 3.256 (106142506/s),
amm multisplit N, D, M, ncodebooks: 230393,  24,   3, 32     (5x5): 7.929 (87173666/s), 7.415 (93216453/s), 7.442 (92878258/s), 7.622 (90684859/s), 7.405 (93342336/s),
amm multisplit N, D, M, ncodebooks:  49284,  27,   2, 32     (5x5): 1.018 (96880157/s), 1.017 (96975417/s), 1.05 (93927619/s), 1.018 (96880157/s), 1.025 (96218536/s),
ncodebooks = 64
amm multisplit N, D, M, ncodebooks:  10000, 512,  10, 64     (5x5): 0.735 (136272108/s), 0.707 (141669024/s), 0.704 (142272727/s), 0.669 (149715994/s), 0.656 (152682926/s),
amm multisplit N, D, M, ncodebooks:  10000, 512, 100, 64     (5x5): 2.118 (472898961/s), 2.247 (445749888/s), 2.22 (451171171/s), 2.085 (480383693/s), 2.006 (499302093/s),
amm multisplit N, D, M, ncodebooks:  57593,  24,   3, 64     (5x5): 2.646 (65306122/s), 2.788 (61979913/s), 2.6 (66461538/s), 2.599 (66487110/s), 2.595 (66589595/s),
amm multisplit N, D, M, ncodebooks: 115193,  24,   3, 64     (5x5): 6.642 (52032520/s), 6.635 (52087415/s), 6.59 (52443095/s), 6.589 (52451054/s), 6.611 (52276508/s),
amm multisplit N, D, M, ncodebooks: 230393,  24,   3, 64     (5x5): 14.724 (46943765/s), 14.579 (47410659/s), 14.453 (47823981/s), 14.639 (47216339/s), 14.647 (47190550/s),
amm multisplit N, D, M, ncodebooks:  49284,  27,   2, 64     (5x5): 2.048 (48156250/s), 2.036 (48440078/s), 2.036 (48440078/s), 2.115 (46630732/s), 2.145 (45978554/s),
ncodebooks = 4
amm bolt N, D, M, ncodebooks:  10000, 512,  10,  4   (5x5): 7.505 (42638241/s), 7.498 (42678047/s), 7.497 (42683740/s), 7.5 (42666666/s), 7.512 (42598509/s),
amm bolt N, D, M, ncodebooks:  10000, 512, 100,  4   (5x5): 7.508 (170484816/s), 7.5 (170666666/s), 7.488 (170940170/s), 7.508 (170484816/s), 7.686 (166536559/s),
amm bolt N, D, M, ncodebooks:  57593,  24,   3,  4   (5x5): 2.047 (900330239/s), 2.168 (850081180/s), 2.034 (906084562/s), 2.036 (905194499/s), 2.035 (905639312/s),
amm bolt N, D, M, ncodebooks: 115193,  24,   3,  4   (5x5): 4.265 (864285111/s), 4.099 (899286655/s), 4.078 (903917606/s), 4.09 (901265525/s), 4.09 (901265525/s),
amm bolt N, D, M, ncodebooks: 230393,  24,   3,  4   (5x5): 8.285 (889870368/s), 8.131 (906724388/s), 8.151 (904499570/s), 8.402 (877478695/s), 8.172 (902175232/s),
amm bolt N, D, M, ncodebooks:  49284,  27,   2,  4   (5x5): 1.931 (816720870/s), 1.932 (816298136/s), 1.93 (817144041/s), 1.926 (818841121/s), 1.933 (815875840/s),
ncodebooks = 8
amm bolt N, D, M, ncodebooks:  10000, 512,  10,  8   (5x5): 7.239 (44205000/s), 7.231 (44253906/s), 7.236 (44223327/s), 7.298 (43847629/s), 7.268 (44028618/s),
amm bolt N, D, M, ncodebooks:  10000, 512, 100,  8   (5x5): 7.829 (163494699/s), 7.769 (164757369/s), 7.698 (166276955/s), 7.715 (165910563/s), 7.799 (164123605/s),
amm bolt N, D, M, ncodebooks:  57593,  24,   3,  8   (5x5): 2.465 (747657606/s), 2.637 (698891164/s), 2.626 (701818735/s), 2.464 (747961038/s), 2.481 (742835953/s),
amm bolt N, D, M, ncodebooks: 115193,  24,   3,  8   (5x5): 5.411 (681237479/s), 5.132 (718272798/s), 5.13 (718552826/s), 5.135 (717853164/s), 5.133 (718132865/s),
amm bolt N, D, M, ncodebooks: 230393,  24,   3,  8   (5x5): 9.865 (747346781/s), 9.859 (747801602/s), 9.858 (747877459/s), 9.858 (747877459/s), 9.909 (744028257/s),
amm bolt N, D, M, ncodebooks:  49284,  27,   2,  8   (5x5): 2.467 (639273611/s), 2.468 (639014586/s), 2.463 (640311814/s), 2.466 (639532846/s), 2.469 (638755771/s),
ncodebooks = 16
amm bolt N, D, M, ncodebooks:  10000, 512,  10, 16   (5x5): 6.384 (50125313/s), 6.236 (51314945/s), 6.382 (50141021/s), 6.523 (49057182/s), 6.427 (49789948/s),
amm bolt N, D, M, ncodebooks:  10000, 512, 100, 16   (5x5): 7.073 (180969885/s), 6.721 (190447850/s), 6.816 (187793427/s), 6.82 (187683284/s), 6.671 (191875281/s),
amm bolt N, D, M, ncodebooks:  57593,  24,   3, 16   (5x5): 4.38 (420770776/s), 4.377 (421059172/s), 4.377 (421059172/s), 4.378 (420962996/s), 4.378 (420962996/s),
amm bolt N, D, M, ncodebooks: 115193,  24,   3, 16   (5x5): 8.62 (427630626/s), 8.237 (447514386/s), 8.46 (435718203/s), 8.59 (429124097/s), 8.307 (443743348/s),
amm bolt N, D, M, ncodebooks: 230393,  24,   3, 16   (5x5): 16.476 (447473658/s), 16.966 (434550041/s), 16.539 (445769151/s), 16.468 (447691037/s), 16.521 (446254827/s),
amm bolt N, D, M, ncodebooks:  49284,  27,   2, 16   (5x5): 3.525 (447400851/s), 3.651 (431960558/s), 3.539 (445630969/s), 3.531 (446640611/s), 3.527 (447147150/s),
ncodebooks = 32
amm bolt N, D, M, ncodebooks:  10000, 512,  10, 32   (5x5): 6.154 (51998700/s), 6.245 (51240992/s), 6.296 (50825921/s), 6.126 (52236369/s), 6.429 (49774459/s),
amm bolt N, D, M, ncodebooks:  10000, 512, 100, 32   (5x5): 7.11 (180028129/s), 7.135 (179397337/s), 7.14 (179271708/s), 7.131 (179497966/s), 7.135 (179397337/s),
ncodebooks = 64
amm bolt N, D, M, ncodebooks:  10000, 512,  10, 64   (5x5): 7.087 (45153097/s), 7.082 (45184975/s), 6.889 (46450863/s), 6.889 (46450863/s), 7.272 (44004400/s),
amm bolt N, D, M, ncodebooks:  10000, 512, 100, 64   (5x5): 8.876 (144209103/s), 8.905 (143739472/s), 9.097 (140705727/s), 8.761 (146102043/s), 9.615 (133125325/s),
matmul N, D, M:  10000,   2,  10     (5x5): 0.032 (3130000000/s), 0.032 (3130000000/s), 0.033 (3035151515/s), 0.032 (3130000000/s), 0.032 (3130000000/s),
matmul N, D, M:  10000,   4,  10     (5x5): 0.062 (1615483870/s), 0.058 (1726896551/s), 0.06 (1669333333/s), 0.055 (1821090909/s), 0.041 (2442926829/s),
matmul N, D, M:  10000,   6,  10     (5x5): 0.046 (2177391304/s), 0.046 (2177391304/s), 0.046 (2177391304/s), 0.046 (2177391304/s), 0.063 (1589841269/s),
matmul N, D, M:  10000,   8,  10     (5x5): 0.073 (1372054794/s), 0.052 (1926153846/s), 0.052 (1926153846/s), 0.052 (1926153846/s), 0.059 (1697627118/s),
matmul N, D, M:  10000,  12,  10     (5x5): 0.085 (1178352941/s), 0.08 (1252000000/s), 0.08 (1252000000/s), 0.08 (1252000000/s), 0.08 (1252000000/s),
matmul N, D, M:  10000,  16,  10     (5x5): 0.094 (1065531914/s), 0.089 (1125393258/s), 0.087 (1151264367/s), 0.086 (1164651162/s), 0.089 (1125393258/s),
matmul N, D, M:  10000,  24,  10     (5x5): 0.182 (550329670/s), 0.124 (807741935/s), 0.151 (663311258/s), 0.147 (681360544/s), 0.12 (834666666/s),
matmul N, D, M:  10000,  27,  10     (5x5): 0.23 (435478260/s), 0.185 (541405405/s), 0.183 (547322404/s), 0.182 (550329670/s), 0.174 (575632183/s),
matmul N, D, M:  10000,  32,  10     (5x5): 0.167 (599760479/s), 0.166 (603373493/s), 0.186 (538494623/s), 0.169 (592662721/s), 0.171 (585730994/s),
matmul N, D, M:  10000,  48,  10     (5x5): 0.296 (338378378/s), 0.29 (345379310/s), 0.283 (353922261/s), 0.269 (372342007/s), 0.27 (370962962/s),
matmul N, D, M:  10000,  64,  10     (5x5): 0.534 (187565543/s), 0.38 (263578947/s), 0.367 (272915531/s), 0.364 (275164835/s), 0.373 (268525469/s),
matmul N, D, M:  10000, 512,  10     (5x5): 6.284 (15938892/s), 6.234 (16066730/s), 6.122 (16360666/s), 6.222 (16097717/s), 6.151 (16283531/s),
matmul N, D, M:  10000,   2, 100     (5x5): 0.355 (2821408450/s), 0.352 (2845454545/s), 0.345 (2903188405/s), 0.363 (2759228650/s), 0.344 (2911627906/s),
matmul N, D, M:  10000,   4, 100     (5x5): 0.355 (2821408450/s), 0.363 (2759228650/s), 0.365 (2744109589/s), 0.359 (2789972144/s), 0.366 (2736612021/s),
matmul N, D, M:  10000,   6, 100     (5x5): 0.401 (2497755610/s), 0.384 (2608333333/s), 0.399 (2510275689/s), 0.383 (2615143603/s), 0.472 (2122033898/s),
matmul N, D, M:  10000,   8, 100     (5x5): 0.433 (2313163972/s), 0.42 (2384761904/s), 0.42 (2384761904/s), 0.424 (2362264150/s), 0.42 (2384761904/s),
matmul N, D, M:  10000,  12, 100     (5x5): 0.635 (1577322834/s), 0.636 (1574842767/s), 0.63 (1589841269/s), 0.663 (1510708898/s), 0.661 (1515279878/s),
matmul N, D, M:  10000,  16, 100     (5x5): 0.642 (1560124610/s), 0.654 (1531498470/s), 0.633 (1582306477/s), 0.652 (1536196319/s), 0.659 (1519878603/s),
matmul N, D, M:  10000,  24, 100     (5x5): 0.794 (1261460957/s), 0.8 (1252000000/s), 0.801 (1250436953/s), 0.789 (1269455006/s), 0.781 (1282458386/s),
matmul N, D, M:  10000,  27, 100     (5x5): 0.99 (1011717171/s), 0.993 (1008660624/s), 1.001 (1000599400/s), 0.991 (1010696266/s), 0.991 (1010696266/s),
matmul N, D, M:  10000,  32, 100     (5x5): 0.992 (1009677419/s), 1.078 (929128014/s), 0.988 (1013765182/s), 0.983 (1018921668/s), 0.995 (1006633165/s),
matmul N, D, M:  10000,  48, 100     (5x5): 1.358 (737555228/s), 1.362 (735389133/s), 1.377 (727378358/s), 1.359 (737012509/s), 1.362 (735389133/s),
matmul N, D, M:  10000,  64, 100     (5x5): 1.787 (560492445/s), 1.724 (580974477/s), 1.723 (581311665/s), 1.727 (579965257/s), 1.724 (580974477/s),
matmul N, D, M:  10000, 512, 100     (5x5): 15.413 (64984104/s), 15.697 (63808371/s), 15.99 (62639149/s), 15.252 (65670076/s), 15.925 (62894819/s),
matmul N, D, M:  57593,   2,   3     (5x5): 0.075 (2304000000/s), 0.074 (2335135135/s), 0.073 (2367123287/s), 0.073 (2367123287/s), 0.073 (2367123287/s),
matmul N, D, M:  57593,   4,   3     (5x5): 0.098 (1763265306/s), 0.099 (1745454545/s), 0.113 (1529203539/s), 0.098 (1763265306/s), 0.095 (1818947368/s),
matmul N, D, M:  57593,   6,   3     (5x5): 0.119 (1452100840/s), 0.12 (1440000000/s), 0.121 (1428099173/s), 0.129 (1339534883/s), 0.12 (1440000000/s),
matmul N, D, M:  57593,   8,   3     (5x5): 0.14 (1234285714/s), 0.14 (1234285714/s), 0.141 (1225531914/s), 0.14 (1234285714/s), 0.14 (1234285714/s),
matmul N, D, M:  57593,  12,   3     (5x5): 0.237 (729113924/s), 0.232 (744827586/s), 0.237 (729113924/s), 0.233 (741630901/s), 0.235 (735319148/s),
matmul N, D, M:  57593,  16,   3     (5x5): 0.321 (538317757/s), 0.297 (581818181/s), 0.29 (595862068/s), 0.288 (600000000/s), 0.284 (608450704/s),
matmul N, D, M:  57593,  24,   3     (5x5): 0.501 (344910179/s), 0.456 (378947368/s), 0.455 (379780219/s), 0.427 (404683840/s), 0.433 (399076212/s),
matmul N, D, M:  57593,  27,   3     (5x5): 0.91 (189890109/s), 0.722 (239335180/s), 0.857 (201633605/s), 0.852 (202816901/s), 0.857 (201633605/s),
matmul N, D, M:  57593,  32,   3     (5x5): 0.844 (204739336/s), 0.842 (205225653/s), 0.847 (204014167/s), 0.842 (205225653/s), 0.859 (201164144/s),
matmul N, D, M:  57593,  48,   3     (5x5): 1.396 (123782234/s), 1.189 (145332211/s), 1.178 (146689303/s), 1.187 (145577085/s), 1.172 (147440273/s),
matmul N, D, M:  57593,  64,   3     (5x5): 1.767 (97792869/s), 1.732 (99769053/s), 1.723 (100290191/s), 1.686 (102491103/s), 1.699 (101706886/s),
matmul N, D, M: 115193,   2,   3     (5x5): 0.143 (2416783216/s), 0.143 (2416783216/s), 0.145 (2383448275/s), 0.144 (2400000000/s), 0.145 (2383448275/s),
matmul N, D, M: 115193,   4,   3     (5x5): 0.197 (1754314720/s), 0.195 (1772307692/s), 0.194 (1781443298/s), 0.22 (1570909090/s), 0.202 (1710891089/s),
matmul N, D, M: 115193,   6,   3     (5x5): 0.255 (1355294117/s), 0.254 (1360629921/s), 0.262 (1319083969/s), 0.265 (1304150943/s), 0.256 (1350000000/s),
matmul N, D, M: 115193,   8,   3     (5x5): 0.36 (960000000/s), 0.32 (1080000000/s), 0.305 (1133114754/s), 0.306 (1129411764/s), 0.316 (1093670886/s),
matmul N, D, M: 115193,  12,   3     (5x5): 0.555 (622702702/s), 0.548 (630656934/s), 0.548 (630656934/s), 0.546 (632967032/s), 0.497 (695372233/s),
matmul N, D, M: 115193,  16,   3     (5x5): 0.662 (522054380/s), 0.662 (522054380/s), 0.661 (522844175/s), 0.662 (522054380/s), 0.665 (519699248/s),
matmul N, D, M: 115193,  24,   3     (5x5): 0.984 (351219512/s), 0.971 (355921730/s), 0.972 (355555555/s), 0.976 (354098360/s), 0.978 (353374233/s),
matmul N, D, M: 115193,  27,   3     (5x5): 1.494 (231325301/s), 1.356 (254867256/s), 1.365 (253186813/s), 1.353 (255432372/s), 1.35 (255999999/s),
matmul N, D, M: 115193,  32,   3     (5x5): 1.378 (250798258/s), 1.356 (254867256/s), 1.353 (255432372/s), 1.37 (252262773/s), 1.36 (254117647/s),
matmul N, D, M: 115193,  48,   3     (5x5): 2.81 (122989323/s), 2.767 (124900614/s), 2.785 (124093357/s), 2.783 (124182536/s), 2.803 (123296468/s),
matmul N, D, M: 115193,  64,   3     (5x5): 3.853 (89696340/s), 3.819 (90494893/s), 3.972 (87009063/s), 3.858 (89580093/s), 3.84 (90000000/s),
matmul N, D, M: 230393,   2,   3     (5x5): 0.297 (2327272727/s), 0.312 (2215384615/s), 0.319 (2166771159/s), 0.322 (2146583850/s), 0.311 (2222508038/s),
matmul N, D, M: 230393,   4,   3     (5x5): 0.497 (1390744466/s), 0.484 (1428099173/s), 0.477 (1449056603/s), 0.468 (1476923076/s), 0.471 (1467515923/s),
matmul N, D, M: 230393,   6,   3     (5x5): 0.595 (1161680672/s), 0.584 (1183561643/s), 0.581 (1189672977/s), 0.628 (1100636942/s), 0.631 (1095404120/s),
matmul N, D, M: 230393,   8,   3     (5x5): 0.724 (954696132/s), 0.719 (961335187/s), 0.724 (954696132/s), 0.718 (962674094/s), 0.723 (956016597/s),
matmul N, D, M: 230393,  12,   3     (5x5): 1.185 (583291139/s), 1.235 (559676113/s), 1.182 (584771573/s), 1.18 (585762711/s), 1.205 (573609958/s),
matmul N, D, M: 230393,  16,   3     (5x5): 1.519 (455036208/s), 1.504 (459574468/s), 1.524 (453543307/s), 1.526 (452948885/s), 1.506 (458964143/s),
matmul N, D, M: 230393,  24,   3     (5x5): 2.048 (337500000/s), 2.048 (337500000/s), 2.064 (334883720/s), 2.061 (335371179/s), 2.056 (336186770/s),
matmul N, D, M: 230393,  27,   3     (5x5): 3.654 (189162561/s), 3.646 (189577619/s), 3.551 (194649394/s), 3.63 (190413223/s), 3.606 (191680532/s),
matmul N, D, M: 230393,  32,   3     (5x5): 3.664 (188646288/s), 3.645 (189629629/s), 3.529 (195862850/s), 3.635 (190151306/s), 3.636 (190099009/s),
matmul N, D, M: 230393,  48,   3     (5x5): 6.038 (114474991/s), 5.937 (116422435/s), 6.043 (114380274/s), 5.758 (120041681/s), 5.708 (121093202/s),
matmul N, D, M: 230393,  64,   3     (5x5): 8.147 (84841045/s), 8.128 (85039370/s), 8.187 (84426529/s), 8.182 (84478122/s), 8.191 (84385300/s),
matmul N, D, M:  49284,   2,   2     (5x5): 0.045 (2191644444/s), 0.045 (2191644444/s), 0.044 (2241454545/s), 0.044 (2241454545/s), 0.044 (2241454545/s),
matmul N, D, M:  49284,   4,   2     (5x5): 0.064 (1541000000/s), 0.064 (1541000000/s), 0.064 (1541000000/s), 0.064 (1541000000/s), 0.064 (1541000000/s),
matmul N, D, M:  49284,   6,   2     (5x5): 0.079 (1248405063/s), 0.079 (1248405063/s), 0.079 (1248405063/s), 0.079 (1248405063/s), 0.079 (1248405063/s),
matmul N, D, M:  49284,   8,   2     (5x5): 0.095 (1038147368/s), 0.094 (1049191489/s), 0.092 (1072000000/s), 0.091 (1083780219/s), 0.091 (1083780219/s),
matmul N, D, M:  49284,  12,   2     (5x5): 0.146 (675506849/s), 0.146 (675506849/s), 0.146 (675506849/s), 0.146 (675506849/s), 0.146 (675506849/s),
matmul N, D, M:  49284,  16,   2     (5x5): 0.178 (554067415/s), 0.177 (557197740/s), 0.178 (554067415/s), 0.177 (557197740/s), 0.178 (554067415/s),
matmul N, D, M:  49284,  24,   2     (5x5): 0.323 (305337461/s), 0.315 (313092063/s), 0.313 (315092651/s), 0.302 (326569536/s), 0.314 (314089171/s),
matmul N, D, M:  49284,  27,   2     (5x5): 0.582 (169457044/s), 0.574 (171818815/s), 0.566 (174247349/s), 0.565 (174555752/s), 0.593 (166313659/s),
matmul N, D, M:  49284,  32,   2     (5x5): 0.567 (173940035/s), 0.566 (174247349/s), 0.583 (169166380/s), 0.573 (172118673/s), 0.573 (172118673/s),
matmul N, D, M:  49284,  48,   2     (5x5): 0.803 (122819427/s), 0.788 (125157360/s), 0.807 (122210656/s), 0.802 (122972568/s), 0.802 (122972568/s),
matmul N, D, M:  49284,  64,   2     (5x5): 1.271 (77595594/s), 1.185 (83227004/s), 1.17 (84294017/s), 1.164 (84728522/s), 1.16 (85020689/s), """


def load_matmul_times_for_n_d_m():
    lines = microbench_output.split('\n')
    matmul_lines = [line for line in lines if line.startswith('matmul')]
    matmul_shape_to_times = {}
    matmul_shape_to_thruputs = {}
    for line in matmul_lines:
        start_idx = line.find(':') + 1
        end_idx = line.find('(')
        nmd_str = line[start_idx:end_idx]
        N, D, M = [int(substr) for substr in nmd_str.split(',')[:3]]
        speeds_str = line[line.find('):') + 2:]
        speed_pairs = speeds_str.split(',')[:5]
        times = []
        thruputs = []
        for pair in speed_pairs:
            pair = pair.strip()
            time_str, thruput_str = pair.split()
            times.append(float(time_str))
            thruput_str = thruput_str.strip('()s/')
            thruputs.append(float(thruput_str))

        key = (N, D, M)
        matmul_shape_to_times[key] = times
        matmul_shape_to_thruputs[key] = thruputs

    # pprint.pprint(matmul_shape_to_times)
    # pprint.pprint(matmul_shape_to_thruputs)

    return matmul_shape_to_times, matmul_shape_to_thruputs


def _load_vq_times_for_n_d_m(startswith):
    lines = microbench_output.split('\n')
    lines = [line for line in lines if line.startswith(startswith)]
    shape_ncodebooks_to_times = {}
    shape_ncodebooks_to_thruputs = {}
    for line in lines:
        start_idx = line.find(':') + 1
        end_idx = line.find('(')
        nmd_str = line[start_idx:end_idx]
        N, D, M, C = [int(substr) for substr in nmd_str.split(',')[:4]]
        speeds_str = line[line.find('):') + 2:]
        speed_pairs = speeds_str.split(',')[:5]
        times = []
        thruputs = []
        for pair in speed_pairs:
            pair = pair.strip()
            time_str, thruput_str = pair.split()
            times.append(float(time_str))
            thruput_str = thruput_str.strip('()s/')
            thruputs.append(float(thruput_str))

        key = (N, D, M, C)
        shape_ncodebooks_to_times[key] = times
        shape_ncodebooks_to_thruputs[key] = thruputs

    # print("startswith: ", startswith)
    # if 'bolt' in startswith:
    #     print("bolt speed dicts:")
    #     pprint.pprint(shape_ncodebooks_to_times)
    #     pprint.pprint(shape_ncodebooks_to_thruputs)

    return shape_ncodebooks_to_times, shape_ncodebooks_to_thruputs


def load_multisplit_times_for_n_d_m():
    return _load_vq_times_for_n_d_m('amm multisplit')


def load_bolt_times_for_n_d_m():
    return _load_vq_times_for_n_d_m('amm bolt')


def main():
    load_matmul_times_for_n_d_m()
    load_multisplit_times_for_n_d_m()
    load_bolt_times_for_n_d_m()


if __name__ == '__main__':
    main()
